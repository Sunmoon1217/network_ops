import{d as y,r as a,o as b,c as o,a as t,t as n,g as C,b as P,F as D,h as $,u as f,i as z,f as s,_ as B}from"./index-Cc9b1Oy-.js";import{a as I}from"./django_api-BTHqDO-9.js";import{P as x}from"./Pagination-DArHUswO.js";const L={class:"device-list-container"},w={key:0,class:"loading"},E={key:1,class:"error"},F={key:2,class:"device-table-container"},M={class:"device-table"},N=["onClick"],S=["onClick"],V=y({__name:"DeviceList",setup(R){const g=z(),_=a([]),c=a(!0),r=a(null),d=a(1),v=a(10),i=a(0),h=a(1);async function p(u=1){c.value=!0,r.value=null;try{const e=await I.get("/devices/",{params:{page:u,page_size:v.value}});_.value=e.data?.results||[],i.value=e.data?.count||0,h.value=Math.ceil(i.value/v.value),d.value=u}catch(e){r.value=e instanceof Error?e.message:"Unknown error"}finally{c.value=!1}}function m(u){p(u)}return b(()=>{p()}),(u,e)=>(s(),o("div",L,[e[3]||(e[3]=t("h2",null,"设备管理",-1)),c.value?(s(),o("div",w,[...e[1]||(e[1]=[t("p",null,"加载中...",-1)])])):r.value?(s(),o("div",E,[t("p",null,"错误: "+n(r.value),1),t("button",{onClick:e[0]||(e[0]=l=>p(d.value))},"重试")])):(s(),o("div",F,[t("table",M,[e[2]||(e[2]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"主机名"),t("th",null,"IP地址"),t("th",null,"用户名"),t("th",null,"设备类型"),t("th",null,"连接失败时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(s(!0),o(D,null,$(_.value,l=>(s(),o("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,n(l.hostname),1),t("td",null,n(l.address),1),t("td",null,n(l.username),1),t("td",null,n(l.device_type),1),t("td",null,n(l.connect_failed_at||"-"),1),t("td",null,[t("button",{class:"config-btn",onClick:k=>f(g).push(`/devices/${l.id}/config`)}," 查看配置 ",8,N),t("button",{class:"history-btn",onClick:k=>f(g).push(`/devices/${l.id}/history`)}," 历史配置 ",8,S)])]))),128))])]),i.value>0?(s(),C(x,{key:0,"current-page":d.value,"total-pages":h.value,"page-size":v.value,"total-items":i.value,"on-page-change":m},null,8,["current-page","total-pages","page-size","total-items"])):P("",!0)]))]))}}),A=B(V,[["__scopeId","data-v-d05fe89b"]]);export{A as default};
