/* empty css         *//* empty css        *//* empty css               */import{d as D,r as o,o as K,c as n,a as t,w as m,v as I,p as P,q as V,F as w,h as y,t as h,m as C,s as N,x as j,E as L,j as O,y as q,f as s,_ as Q}from"./index.js";import{a as F}from"./django_api.js";const R={class:"interface-management-container"},W={class:"filters-container"},$={class:"filter-row"},G={class:"filter-item"},H={class:"filter-item"},J=["value"],X={class:"filter-item"},Y=["value"],Z={class:"filter-item"},ee={key:0,class:"loading"},te={key:1,class:"error"},le={key:2,class:"interface-table-container"},ae=D({__name:"InterfaceManagementView",setup(oe){const b=o([]),g=o(!0),p=o(null),f=o(1),U=o(15),k=o(0),i=o(""),u=o("all"),r=o("all"),d=o(""),x=o([]),E=[{value:"all",label:"全部状态"},{value:"up",label:"启用"},{value:"down",label:"禁用"},{value:"admin_down",label:"管理关闭"}];async function M(){try{console.log("获取设备列表 - 发送请求");const a=await F.get("/devices/");console.log("获取设备列表 - 响应:",a),x.value=a.data?.results?.map(e=>({id:e.id,name:e.hostname}))||[]}catch(a){console.error("获取设备列表失败:",a)}}const B=o([{prop:"device_name",label:"设备名称",width:230,sortable:!0},{prop:"interface",label:"接口名称",width:200,sortable:!0},{prop:"description",label:"接口描述",minWidth:200,showOverflowTooltip:!0},{prop:"vrf",label:"VPN实例",width:150,sortable:!0},{prop:"if_address",label:"接口地址",width:180,sortable:!0},{prop:"shutdown",label:"状态",width:120,sortable:!0,formatter:a=>a.shutdown?"Shutdown":"UP"}]);async function c(a=1){g.value=!0,p.value=null;try{const e={page:a,page_size:U.value};i.value&&(e.search=i.value),u.value!=="all"&&(e.status=u.value),r.value!=="all"&&(console.log("过滤设备名：",r.value),e.device=r.value),d.value&&(e.ip_address=d.value),console.log("发送API请求:",{url:"/interfaces/",params:e,baseURL:"/api"});const v=await F.get("/interfaces/",{params:e});console.log("API响应:",v),b.value=v.data?.results||[],k.value=v.data?.count||0,f.value=a}catch(e){console.error("API请求失败:",e),p.value=e instanceof Error?e.message:"获取接口配置失败"}finally{g.value=!1}}function S(){i.value="",u.value="all",r.value="all",d.value="",c(1)}function _(){c(1)}const T=a=>{f.value=a,c(a)};return K(async()=>{console.log("组件挂载 - 开始初始化数据"),await M(),console.log("组件挂载 - 设备列表获取完成，开始获取接口数据"),await c(),console.log("组件挂载 - 接口数据获取完成"),console.log("组件挂载 - 接口数据:",b.value)}),(a,e)=>{const v=q,z=j,A=L;return s(),n("div",R,[e[11]||(e[11]=t("h2",{class:"viewtitle"},"接口管理",-1)),t("div",W,[t("div",$,[t("div",G,[e[5]||(e[5]=t("label",{for:"search"},"搜索:",-1)),m(t("input",{id:"search","onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),type:"text",placeholder:"搜索接口名称、描述...",onKeyup:P(_,["enter"])},null,544),[[I,i.value]])]),t("div",H,[e[6]||(e[6]=t("label",{for:"status"},"状态:",-1)),m(t("select",{id:"status","onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l)},[(s(),n(w,null,y(E,l=>t("option",{key:l.value,value:l.value},h(l.label),9,J)),64))],512),[[V,u.value]])]),t("div",X,[e[8]||(e[8]=t("label",{for:"device"},"设备:",-1)),m(t("select",{id:"device","onUpdate:modelValue":e[2]||(e[2]=l=>r.value=l)},[e[7]||(e[7]=t("option",{value:"all"},"所有设备",-1)),(s(!0),n(w,null,y(x.value,l=>(s(),n("option",{key:l.id,value:l.id},h(l.name),9,Y))),128))],512),[[V,r.value]])]),t("div",Z,[e[9]||(e[9]=t("label",{for:"ip"},"IP地址:",-1)),m(t("input",{id:"ip","onUpdate:modelValue":e[3]||(e[3]=l=>d.value=l),type:"text",placeholder:"例如: 192.168.1.",onKeyup:P(_,["enter"])},null,544),[[I,d.value]])])]),t("div",{class:"filter-buttons-row"},[t("button",{onClick:_,class:"apply-btn"},"应用过滤器"),t("button",{onClick:S,class:"reset-btn"},"重置")])]),g.value?(s(),n("div",ee,[...e[10]||(e[10]=[t("p",null,"加载中...",-1)])])):p.value?(s(),n("div",te,[t("p",null,"错误: "+h(p.value),1),t("button",{onClick:e[4]||(e[4]=l=>c(f.value)),class:"retry-btn"},"重试")])):(s(),n("div",le,[C(z,{data:b.value,stripe:"",class:"interface-table"},{default:N(()=>[(s(!0),n(w,null,y(B.value,l=>(s(),O(v,{prop:l.prop,label:l.label,width:l.width},null,8,["prop","label","width"]))),256))]),_:1},8,["data"]),C(A,{class:"table-pagination","current-page":f.value,"onUpdate:currentPage":T,background:"",layout:"->, total, jumper, prev, pager, next",total:k.value,"page-size":15},null,8,["current-page","total"])]))])}}}),de=Q(ae,[["__scopeId","data-v-89cf1d98"]]);export{de as default};
