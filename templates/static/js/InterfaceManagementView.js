/* empty css         *//* empty css        *//* empty css               */import{d as N,r as s,o as $,c as n,a as t,w as m,v as I,p as V,q as z,F as h,h as y,t as k,m as C,s as j,x as L,E as O,j as R,y as q,i as Q,f as o,_ as W}from"./index.js";import{a as F}from"./django_api.js";const G={class:"interface-management-container"},H={class:"filters-container"},J={class:"filter-row"},X={class:"filter-item"},Y={class:"filter-item"},Z=["value"],ee={class:"filter-item"},te=["value"],le={class:"filter-item"},ae={key:0,class:"loading"},se={key:1,class:"error"},oe={key:2,class:"interface-table-container"},ne=N({__name:"InterfaceManagementView",emits:["page-change","size-change","refresh"],setup(ie,{emit:re}){Q();const b=s([]),g=s(!0),p=s(null),f=s(1),P=s(15),_=s(0),U=s(0),E=s("default"),i=s(""),r=s("all"),u=s("all"),c=s(""),x=s([]),M=[{value:"all",label:"全部状态"},{value:"up",label:"启用"},{value:"down",label:"禁用"},{value:"admin_down",label:"管理关闭"}];async function D(){try{console.log("获取设备列表 - 发送请求");const a=await F.get("/devices/");console.log("获取设备列表 - 响应:",a),x.value=a.data?.results?.map(e=>({id:e.id,name:e.hostname}))||[]}catch(a){console.error("获取设备列表失败:",a)}}const T=s([{prop:"device_name",label:"设备名称",width:230,sortable:!0,formatter:a=>`<span class="clickable" @click="goToDeviceDetails(${a.device_id})"><i class="el-icon-view"></i> ${a.device_name||"-"}</span>`},{prop:"interface",label:"接口名称",width:200,sortable:!0},{prop:"description",label:"接口描述",minWidth:200,showOverflowTooltip:!0},{prop:"vrf",label:"VPN实例",width:150,sortable:!0},{prop:"if_address",label:"接口地址",width:180,sortable:!0},{prop:"shutdown",label:"状态",width:120,sortable:!0,formatter:a=>a.shutdown?"Shutdown":"UP"}]);async function d(a=1){g.value=!0,p.value=null;try{const e={page:a,page_size:P.value};i.value&&(e.search=i.value),r.value!=="all"&&(e.status=r.value),u.value!=="all"&&(e.device=u.value),c.value&&(e.ip_address=c.value),console.log("发送API请求:",{url:"/interfaces/",params:e,baseURL:"/api"});const v=await F.get("/interfaces/",{params:e});console.log("API响应:",v),b.value=v.data?.results||[],_.value=v.data?.count||0,U.value=Math.ceil(_.value/P.value),f.value=a}catch(e){console.error("API请求失败:",e),p.value=e instanceof Error?e.message:"获取接口配置失败"}finally{g.value=!1}}function B(){i.value="",r.value="all",u.value="all",c.value="",d(1)}function w(){d(1)}const S=a=>{f.value=a,d(a)};return $(async()=>{console.log("组件挂载 - 开始初始化数据"),await D(),console.log("组件挂载 - 设备列表获取完成，开始获取接口数据"),await d(),console.log("组件挂载 - 接口数据获取完成"),console.log("组件挂载 - 接口数据:",b.value)}),(a,e)=>{const v=q,A=L,K=O;return o(),n("div",G,[e[11]||(e[11]=t("h2",{class:"viewtitle"},"接口管理",-1)),t("div",H,[t("div",J,[t("div",X,[e[5]||(e[5]=t("label",{for:"search"},"搜索:",-1)),m(t("input",{id:"search","onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),type:"text",placeholder:"搜索接口名称、描述...",onKeyup:V(w,["enter"])},null,544),[[I,i.value]])]),t("div",Y,[e[6]||(e[6]=t("label",{for:"status"},"状态:",-1)),m(t("select",{id:"status","onUpdate:modelValue":e[1]||(e[1]=l=>r.value=l)},[(o(),n(h,null,y(M,l=>t("option",{key:l.value,value:l.value},k(l.label),9,Z)),64))],512),[[z,r.value]])]),t("div",ee,[e[8]||(e[8]=t("label",{for:"device"},"设备:",-1)),m(t("select",{id:"device","onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l)},[e[7]||(e[7]=t("option",{value:"all"},"所有设备",-1)),(o(!0),n(h,null,y(x.value,l=>(o(),n("option",{key:l.id,value:l.id},k(l.name),9,te))),128))],512),[[z,u.value]])]),t("div",le,[e[9]||(e[9]=t("label",{for:"ip"},"IP地址:",-1)),m(t("input",{id:"ip","onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),type:"text",placeholder:"例如: 192.168.1.",onKeyup:V(w,["enter"])},null,544),[[I,c.value]])]),t("div",{class:"filter-buttons"},[t("button",{onClick:w,class:"apply-btn"},"应用过滤器"),t("button",{onClick:B,class:"reset-btn"},"重置")])])]),g.value?(o(),n("div",ae,[...e[10]||(e[10]=[t("p",null,"加载中...",-1)])])):p.value?(o(),n("div",se,[t("p",null,"错误: "+k(p.value),1),t("button",{onClick:e[4]||(e[4]=l=>d(f.value)),class:"retry-btn"},"重试")])):(o(),n("div",oe,[C(A,{data:b.value,class:"interface-table"},{default:j(()=>[(o(!0),n(h,null,y(T.value,l=>(o(),R(v,{prop:l.prop,label:l.label,width:l.width},null,8,["prop","label","width"]))),256))]),_:1},8,["data"]),C(K,{style:{height:"10%"},"current-page":f.value,"onUpdate:currentPage":S,"page-sizes":[15,30,50,100],background:"",size:E.value,layout:"->, total, jumper, prev, pager, next, sizes",total:_.value},null,8,["current-page","size","total"])]))])}}}),fe=W(ne,[["__scopeId","data-v-74b0c4e3"]]);export{fe as default};
