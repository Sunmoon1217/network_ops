/* empty css         *//* empty css        */import{d as x,r as a,o as I,l as V,c as s,a as e,t as l,b as $,F as B,h as E,m as N,E as S,i as z,n as L,f as o,_ as P}from"./index.js";import{a as C}from"./django_api.js";/* empty css                                                          */const F={class:"history-container"},H={key:0,class:"loading"},M={key:1,class:"error"},R={key:2,class:"history-content"},U={class:"device-header"},j={class:"history-wrapper"},q={class:"config-list"},A={key:0,class:"no-configs"},G={key:1,class:"config-items"},J=["onClick"],K={class:"config-time"},O={class:"config-id"},Q={key:2,class:"pagination-container"},T={class:"config-detail"},W={key:0,class:"detail-content"},X={class:"detail-header"},Y={class:"detail-meta"},Z={class:"config-text"},ee={key:1,class:"no-selected"},te=x({__name:"DeviceConfigHistoryView",setup(se){const w=V(),_=z(),u=a(null),f=a(""),d=a([]),i=a(null),g=a(!0),r=a(null),m=a(1),h=a(10),p=a(0),y=a(1);function D(){_.options.history.state.back?_.back():_.push(`/devices/${u.value}/config`)}async function k(n=1){g.value=!0,r.value=null;try{const t=await C.get(`/devices/${u.value}/`);f.value=t.data?.hostname||"";const v=await C.get(`/configs/?device=${u.value}&ordering=-time`,{params:{page:n,page_size:h.value}});d.value=v.data?.results||[],p.value=v.data.count||0,y.value=Math.ceil(p.value/h.value),m.value=n,d.value.length>0&&(i.value=d.value[0]||null)}catch(t){r.value=t instanceof Error?t.message:"Unknown error"}finally{g.value=!1}}function b(n){i.value=n}return I(()=>{const n=w.params.id;typeof n=="string"&&(u.value=parseInt(n),k())}),(n,t)=>{const v=S;return o(),s("div",F,[t[6]||(t[6]=e("h2",null,"设备历史配置",-1)),g.value?(o(),s("div",H,[...t[1]||(t[1]=[e("p",null,"加载中...",-1)])])):r.value?(o(),s("div",M,[e("p",null,"错误: "+l(r.value),1),e("button",{onClick:t[0]||(t[0]=c=>k(m.value))},"重试")])):(o(),s("div",R,[e("div",U,[e("h3",null,"设备: "+l(f.value),1),e("div",{class:"header-actions"},[e("button",{onClick:D,class:"back-btn"},"返回")])]),e("div",j,[e("div",q,[t[3]||(t[3]=e("h4",null,"配置历史",-1)),d.value.length===0?(o(),s("div",A,[...t[2]||(t[2]=[e("p",null,"该设备暂无配置记录",-1)])])):(o(),s("ul",G,[(o(!0),s(B,null,E(d.value,c=>(o(),s("li",{key:c.id,class:L(["config-item",{active:i.value?.id===c.id}]),onClick:oe=>b(c)},[e("div",K,l(new Date(c.time).toLocaleString()),1),e("div",O,"#"+l(c.id),1)],10,J))),128))])),p.value>0?(o(),s("div",Q,[N(v,{small:"","hide-on-single-page":"1",layout:"prev, pager, next",total:y.value},null,8,["total"])])):$("",!0)]),e("div",T,[i.value?(o(),s("div",W,[e("div",X,[t[4]||(t[4]=e("h4",null,"配置详情",-1)),e("div",Y,[e("span",null,"配置ID: "+l(i.value.id),1),e("span",null,"保存时间: "+l(new Date(i.value.time).toLocaleString()),1)])]),e("pre",Z,l(i.value.config_text),1)])):(o(),s("div",ee,[...t[5]||(t[5]=[e("p",null,"请选择一个配置查看详情",-1)])]))])])]))])}}}),de=P(te,[["__scopeId","data-v-2291004c"]]);export{de as default};
