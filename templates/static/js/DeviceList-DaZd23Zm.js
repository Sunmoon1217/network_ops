import{d as y,o as b,c as o,a as t,u as _,t as n,F as C,g as P,h as $,e as D,i as z,r as a,f as s,_ as B}from"./index-BPjY2MLL.js";import{a as I}from"./django_api-aive4Gka.js";import{P as x}from"./Pagination-iCWmofX_.js";const L={class:"device-list-container"},w={class:"device-list-header"},E={key:0,class:"loading"},F={key:1,class:"error"},M={key:2,class:"device-table-container"},N={class:"device-table"},S=["onClick"],V=["onClick"],R=y({__name:"DeviceList",setup(U){const c=z(),h=a([]),d=a(!0),i=a(null),v=a(1),p=a(10),r=a(0),m=a(1);async function g(u=1){d.value=!0,i.value=null;try{const e=await I.get("/devices/",{params:{page:u,page_size:p.value}});h.value=e.data?.results||[],r.value=e.data?.count||0,m.value=Math.ceil(r.value/p.value),v.value=u}catch(e){i.value=e instanceof Error?e.message:"Unknown error"}finally{d.value=!1}}function f(u){g(u)}return b(()=>{g()}),(u,e)=>(s(),o("div",L,[t("div",w,[e[2]||(e[2]=t("h2",null,"设备管理",-1)),t("button",{class:"add-device-btn",onClick:e[0]||(e[0]=l=>_(c).push("/devices/create"))},"添加设备")]),d.value?(s(),o("div",E,[...e[3]||(e[3]=[t("p",null,"加载中...",-1)])])):i.value?(s(),o("div",F,[t("p",null,"错误: "+n(i.value),1),t("button",{onClick:e[1]||(e[1]=l=>g(v.value))},"重试")])):(s(),o("div",M,[t("table",N,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"主机名"),t("th",null,"IP地址"),t("th",null,"用户名"),t("th",null,"设备类型"),t("th",null,"连接失败时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(s(!0),o(C,null,P(h.value,l=>(s(),o("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,n(l.hostname),1),t("td",null,n(l.address),1),t("td",null,n(l.username),1),t("td",null,n(l.device_type),1),t("td",null,n(l.connect_failed_at||"-"),1),t("td",null,[t("button",{class:"config-btn",onClick:k=>_(c).push(`/devices/${l.id}/config`)}," 查看配置 ",8,S),t("button",{class:"history-btn",onClick:k=>_(c).push(`/devices/${l.id}/history`)}," 历史配置 ",8,V)])]))),128))])]),r.value>0?(s(),$(x,{key:0,"current-page":v.value,"total-pages":m.value,"page-size":p.value,"total-items":r.value,"on-page-change":f},null,8,["current-page","total-pages","page-size","total-items"])):D("",!0)]))]))}}),G=B(R,[["__scopeId","data-v-5c426bcc"]]);export{G as default};
