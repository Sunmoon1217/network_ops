import{d as y,g as k,c as u,a as e,t as o,F as C,h as $,n as V,f as i,_ as x,r,o as z,u as _,i as I,j as M,b as D}from"./index.js";import{a as N}from"./django_api.js";/* empty css                                                          */const S={class:"pagination-container"},B={class:"pagination-info"},F={class:"pagination-controls"},L=["disabled"],R={class:"page-numbers"},T=["disabled","onClick"],w=["disabled"],E=y({__name:"Pagination",props:{currentPage:{default:1},totalPages:{default:1},pageSize:{default:10},totalItems:{default:0},onPageChange:{type:Function,default:()=>{}}},setup(c){const t=c,f=()=>{const s=(t.currentPage-1)*t.pageSize+1,p=Math.min(s+t.pageSize-1,t.totalItems);return{start:s,end:p}},h=()=>{const s=[];if(t.totalPages<=5)for(let n=1;n<=t.totalPages;n++)s.push(n);else{const n=Math.floor(2.5);let a=Math.max(1,t.currentPage-n),l=Math.min(t.totalPages,a+5-1);l-a+1<5&&(a=Math.max(1,l-5+1)),a>1&&(s.push(1),a>2&&s.push("..."));for(let m=a;m<=l;m++)s.push(m);l<t.totalPages&&(l<t.totalPages-1&&s.push("..."),s.push(t.totalPages))}return s},d=k(()=>h()),g=k(()=>f()),P=()=>{t.currentPage>1&&t.onPageChange(t.currentPage-1)},v=()=>{t.currentPage<t.totalPages&&t.onPageChange(t.currentPage+1)},b=s=>{typeof s=="number"&&s>=1&&s<=t.totalPages&&s!==t.currentPage&&t.onPageChange(s)};return(s,p)=>(i(),u("div",S,[e("div",B,[e("span",null,"显示 "+o(g.value.start)+" - "+o(g.value.end)+" 条，共 "+o(c.totalItems)+" 条",1)]),e("div",F,[e("button",{class:"page-btn",disabled:c.currentPage===1,onClick:P},"上一页",8,L),e("div",R,[(i(!0),u(C,null,$(d.value,(n,a)=>(i(),u("button",{key:a,class:V(["page-btn",{"current-page":typeof n=="number"&&n===c.currentPage,ellipsis:n==="..."}]),disabled:n==="...",onClick:l=>b(n)},o(n),11,T))),128))]),e("button",{class:"page-btn",disabled:c.currentPage===c.totalPages,onClick:v}," 下一页 ",8,w)])]))}}),j=x(E,[["__scopeId","data-v-0da8a7c9"]]),U={class:"device-list-container"},q={class:"device-list-header"},A={key:0,class:"loading"},G={key:1,class:"error"},H={key:2,class:"device-table-container"},J={class:"device-table"},K=["onClick"],O=["onClick"],Q=y({__name:"DeviceList",setup(c){const t=I(),f=r([]),h=r(!0),d=r(null),g=r(1),P=r(10),v=r(0),b=r(1);async function s(n=1){h.value=!0,d.value=null;try{const a=await N.get("/devices/",{params:{page:n,page_size:P.value}});f.value=a.data?.results||[],v.value=a.data?.count||0,b.value=Math.ceil(v.value/P.value),g.value=n}catch(a){d.value=a instanceof Error?a.message:"Unknown error"}finally{h.value=!1}}function p(n){s(n)}return z(()=>{s()}),(n,a)=>(i(),u("div",U,[e("div",q,[a[2]||(a[2]=e("h2",null,"设备管理",-1)),e("button",{class:"add-device-btn",onClick:a[0]||(a[0]=l=>_(t).push("/devices/create"))},"添加设备")]),h.value?(i(),u("div",A,[...a[3]||(a[3]=[e("p",null,"加载中...",-1)])])):d.value?(i(),u("div",G,[e("p",null,"错误: "+o(d.value),1),e("button",{onClick:a[1]||(a[1]=l=>s(g.value))},"重试")])):(i(),u("div",H,[e("table",J,[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"主机名"),e("th",null,"IP地址"),e("th",null,"用户名"),e("th",null,"设备类型"),e("th",null,"连接失败时间"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),u(C,null,$(f.value,l=>(i(),u("tr",{key:l.id},[e("td",null,o(l.id),1),e("td",null,o(l.hostname),1),e("td",null,o(l.address),1),e("td",null,o(l.username),1),e("td",null,o(l.device_type),1),e("td",null,o(l.connect_failed_at||"-"),1),e("td",null,[e("button",{class:"config-btn",onClick:m=>_(t).push(`/devices/${l.id}/config`)}," 查看配置 ",8,K),e("button",{class:"history-btn",onClick:m=>_(t).push(`/devices/${l.id}/history`)}," 历史配置 ",8,O)])]))),128))])]),v.value>0?(i(),M(j,{key:0,"current-page":g.value,"total-pages":b.value,"page-size":P.value,"total-items":v.value,"on-page-change":p},null,8,["current-page","total-pages","page-size","total-items"])):D("",!0)]))]))}}),Z=x(Q,[["__scopeId","data-v-5c426bcc"]]);export{Z as default};
